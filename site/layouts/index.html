<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

    <head>
        {{ partial "head/metadata.html" . }}
        {{ if .Site.Params.plausible }}{{ partial "head/plausible.html" . }}{{ end }}
        {{ partial "head/openGraph.html" . }}
        {{ partial "head/favicons.html" . }}
        {{ partial "head/css.html" . }}
        {{ partial "css/owlCarousel.html" . }}
        {{ $customCSS := resources.Get "css/custom.css" | minify | fingerprint }}
        <link rel="stylesheet" href="{{ $customCSS.Permalink }}" integrity="{{ $customCSS.Data.Integrity }}" crossorigin="anonymous">
    </head>

    <body>
        {{ with .Site.GetPage "/home" }}
        <section id="top" class="hero is-{{ .Site.Params.home.introHeight | default "fullheight" }}">
            <div class="hero-head"></div>
            <div class="hero-body">
                <div class="container has-text-centered">
                    <h1 class="bold-title">
                        <span class="typing-container">
                            <span class="typing-text">{{ .Title | markdownify }}</span>
                        </span>
                    </h1>
                    <div class="subtitle is-3">
                        <span class="typing-container">
                            <span class="typing-text typing-text-delay">Senior game engineer</span>
                        </span>
                    </div>
                </div>
            </div>
            {{ end }}

            <div class="scroll-arrow-wrap">
                <a href="#content-anchor" class="scroll-arrow" id="scroll-arrow" aria-label="Scroll down">
                    <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </a>
            </div>

        </section>

        {{/* Sticky tab bar - outside hero so sticky works */}}
        <div class="section-tabs" id="content-anchor">
            <div class="container">
                <div class="tabs-nav">
                    {{ with .Site.GetPage "/home" }}
                    {{ $home := . }}
                    {{ $pages := .Resources.ByType "page" }}
                    {{ with .Site.GetPage "/blog" }}
                        {{ $pages = $pages | append . }}
                    {{ end }}
                    {{ with .Site.GetPage "/projects" }}
                        {{ $pages = $pages | append . }}
                    {{ end }}
                    {{ range sort $pages "Params.weight" }}
                        {{ if .File }}
                        {{ $id := "" }}
                        {{ if eq (os.Stat .File.Dir).Name "projects" }}
                            {{ $id = "projects" }}
                        {{ else if eq (os.Stat .File.Dir).Name "blog" }}
                            {{ $id = "blog" }}
                        {{ else }}
                            {{ $id = .File.TranslationBaseName }}
                        {{ end }}
                        <a class="tab-link" href="#{{ $id }}" data-tab="{{ $id }}">
                            {{ .Title | markdownify }}
                        </a>
                        {{ end }}
                    {{ end }}
                    {{ end }}
                    <div class="tab-indicator"></div>
                </div>
            </div>
        </div>
        {{/* Tab content panels */}}
        <div class="tab-panels">
            {{ with .Site.GetPage "/home" }}
            {{ $home := . }}
            {{ $pages := .Resources.ByType "page" }}
            {{ with .Site.GetPage "/blog" }}
                {{ $pages = $pages | append . }}
            {{ end }}
            {{ with .Site.GetPage "/projects" }}
                {{ $pages = $pages | append . }}
            {{ end }}

            {{ range sort $pages "Params.weight" }}
            {{ if .File }}
            {{ if eq (os.Stat .File.Dir).Name "projects" }}
                <div class="tab-panel" data-panel="projects">
                    {{ partial "home/projects.html" . }}
                </div>
            {{ else if eq (os.Stat .File.Dir).Name "blog" }}
                <div class="tab-panel" data-panel="blog">
                    {{ partial "home/blog.html" . }}
                </div>
            {{ else }}
                <div class="tab-panel" data-panel="{{ .File.TranslationBaseName }}">
                    <div class="section" id="{{ .File.TranslationBaseName }}">
                        <div class="container">
                            <h2 class="title is-2 has-text-centered">{{ .Title | markdownify }}</h2>
                            {{ if .Params.Image }}
                            <div class="columns about-columns">
                                <div class="column is-one-third has-text-centered">
                                    {{ with $home.Resources.GetMatch .Params.Image }}
                                    {{ with .Resize "320x" }}
                                    <img class="img-responsive avatar" src="{{ .Permalink }}" alt="{{ .Name }}">
                                    {{ end }}
                                    {{ end }}
                                </div>
                                <div class="markdown column about-content">
                                    {{ .Content }}
                                </div>
                            </div>
                            {{ else }}
                            <div class="markdown has-text-centered">
                                {{ .Content }}
                            </div>
                            {{ end }}
                        </div>
                    </div>
                </div>
            {{ end }}
            {{ end }}
            {{ end }}
            {{ end }}
        </div>

        {{ partial "footer/text.html" . }}
        {{ partial "footer/scripts.html" . }}
        {{ partial "js/owlCarousel.html" . }}

        {{ if .Site.Params.home.localTime }}
        <script>
            function update_localtime() {
                const time = new Date().toLocaleTimeString('{{ .Site.Params.home.timeFormat }}', { timeZone: '{{ .Site.Params.home.timeZone }}', timeStyle: 'short' });
                document.getElementById('time').textContent = time;
            }
            update_localtime();
            setInterval(update_localtime, 1000);
        </script>
        {{ end }}

        {{ $mainJS := resources.Get "js/main.js" | minify | fingerprint }}
        <script src="{{ $mainJS.Permalink }}" integrity="{{ $mainJS.Data.Integrity }}" crossorigin="anonymous" defer></script>
    </body>
</html>
